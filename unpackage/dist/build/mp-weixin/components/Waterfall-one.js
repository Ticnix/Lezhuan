"use strict";const e=require("../common/vendor.js");Math||t();const t=()=>"../node-modules/@dcloudio/uni-ui/lib/uni-tag/uni-tag.js",r={__name:"Waterfall-one",props:{list:{type:Array,default:()=>[],required:!0},columnCount:{type:Number,default:2,validator:e=>e>=1&&e<=5},gap:{type:Number,default:20},borderRadius:{type:Number,default:10},contentPadding:{type:Number,default:16},titleSize:{type:Number,default:28},titleMarginTop:{type:Number,default:8},priceSize:{type:Number,default:26},priceMarginTop:{type:Number,default:8},priceColor:{type:String,default:"#ff4d4f"},userInfoMarginTop:{type:Number,default:12},avatarSize:{type:Number,default:40},nicknameSize:{type:Number,default:24},nicknameMarginLeft:{type:Number,default:8}},setup(t){const r=t,a=e=>"需求"===e?"warning":"可刀"===e||"不可刀"===e?"error":"primary",i=e.ref([]),n=e.ref([]),p=e.ref([]),u=e.ref({}),l=e.computed(()=>`calc( (100% - ${(r.columnCount-1)*r.gap}rpx) / ${r.columnCount} )`),o=()=>{p.value=Array(r.columnCount).fill(0),p.value[0]=300,n.value=Array.from({length:r.columnCount-1},()=>[]),i.value=[],d()},d=()=>{r.list.filter(e=>e&&e.id).forEach(e=>{var t;const r=p.value.indexOf(Math.min(...p.value));0===r?i.value.push(e):n.value[r-1].push(e);const a=(null==(t=e.tags)?void 0:t.length)>1?20*(e.tags.length-1):0,u="出物"===e.type?320:300;p.value[r]+=u+a})},g=(t,r)=>{e.index.getImageInfo({src:t.imgUrl,success:e=>{var a;u.value[t.id]={width:e.width,height:e.height};const i=300*(e.height/e.width)+(120+((null==(a=t.tags)?void 0:a.length)>1?20:0));p.value[r]=i},fail:()=>{t.imgUrl="https://api.shaolezhuan.cn/lzphoto/productDefault.jpg"}})},c=(t,r)=>{const a=r||"product";e.index.navigateTo({url:`/pages/ProductDetail/ProductDetail?id=${t}&type=${a}`})};return e.watch(()=>[r.list,r.columnCount,r.gap],()=>o(),{deep:!0,immediate:!0}),e.onMounted(()=>{o()}),(r,p)=>({a:`${t.borderRadius}rpx`,b:t.gap+"rpx",c:e.f(i.value,(t,r,i)=>{var n,p;return e.e({a:t.imgUrl,b:t.title,c:e.o(e=>g(t,0),t.id),d:t.tags&&t.tags.length>0},t.tags&&t.tags.length>0?{e:e.f(t.tags,(t,r,n)=>({a:"74530474-0-"+i+"-"+n,b:e.p({size:"mini",text:t,type:a(t)}),c:r}))}:{},{f:e.t(t.title),g:e.t((t.type,"￥")),h:e.t(t.price),i:null==(n=t.user)?void 0:n.avatar,j:e.t((null==(p=t.user)?void 0:p.nickname)||"未知用户"),k:t.id,l:e.o(e=>c(t.id,t.type),t.id)})}),d:`${t.borderRadius}rpx ${t.borderRadius}rpx 0 0`,e:`${t.titleSize}rpx`,f:`${t.titleMarginTop}rpx`,g:`${t.priceSize}rpx`,h:`${t.priceMarginTop}rpx`,i:t.priceColor,j:`${t.avatarSize}rpx`,k:`${t.avatarSize}rpx`,l:t.avatarSize/2+"rpx",m:`${t.nicknameSize}rpx`,n:`${t.nicknameMarginLeft}rpx`,o:`${t.userInfoMarginTop}rpx`,p:`${t.contentPadding}rpx`,q:t.gap+"rpx",r:l.value,s:e.f(n.value,(t,r,i)=>({a:e.f(t,(t,n,p)=>{var u,l;return e.e({a:t.imgUrl,b:t.title,c:e.o(e=>g(t,r+1),t.id),d:t.tags&&t.tags.length>0},t.tags&&t.tags.length>0?{e:e.f(t.tags,(t,r,n)=>({a:"74530474-1-"+i+"-"+p+"-"+n,b:e.p({size:"mini",text:t,type:a(t)}),c:r}))}:{},{f:e.t(t.title),g:e.t((t.type,"￥")),h:e.t(t.price),i:null==(u=t.user)?void 0:u.avatar,j:e.t((null==(l=t.user)?void 0:l.nickname)||"未知用户"),k:t.id,l:e.o(e=>c(t.id),t.id)})}),b:r+1})),t:`${t.borderRadius}rpx ${t.borderRadius}rpx 0 0`,v:`${t.titleSize}rpx`,w:`${t.titleMarginTop}rpx`,x:`${t.priceSize}rpx`,y:`${t.priceMarginTop}rpx`,z:t.priceColor,A:`${t.avatarSize}rpx`,B:`${t.avatarSize}rpx`,C:t.avatarSize/2+"rpx",D:`${t.nicknameSize}rpx`,E:`${t.nicknameMarginLeft}rpx`,F:`${t.userInfoMarginTop}rpx`,G:`${t.contentPadding}rpx`,H:t.gap+"rpx",I:l.value})}},a=e._export_sfc(r,[["__scopeId","data-v-74530474"]]);wx.createComponent(a);
