{"version":3,"file":"demand.js","sources":["pages/demand/demand.vue","D:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvZGVtYW5kL2RlbWFuZC52dWU"],"sourcesContent":["<template>\n  <view class=\"my-published-page\">\n    <!-- 顶部导航栏 -->\n    <view class=\"navbar\">\n      <text class=\"nav-title\">我发布的需求</text>\n      <button class=\"add-demand-btn\" @click=\"goToPublish\">\n        <uni-icons type=\"plus\" size=\"24\" color=\"#fff\"></uni-icons>\n        <text class=\"add-text\">发需求</text>\n      </button>\n    </view>\n    \n    <!-- 搜索和筛选区域 -->\n    <view class=\"filter-container\">\n      <view class=\"search-box\">\n        <uni-icons type=\"search\" size=\"24\" color=\"#999\" class=\"search-icon\"></uni-icons>\n        <input \n          type=\"text\" \n          placeholder=\"搜索我的需求...\" \n          v-model=\"searchKeyword\"\n          @input=\"handleSearch\"\n          class=\"search-input\"\n        />\n      </view>\n      \n      <view class=\"picker-container\">\n        <view class=\"picker-item\">\n          <text class=\"picker-label\">分类:</text>\n          <picker \n            mode=\"selector\"\n            :range=\"categoryRange\"\n            :value=\"categoryIndex\"\n            @change=\"handleCategoryChange\"\n            class=\"custom-picker\"\n          >\n            <view class=\"picker-display\">\n              {{ categoryRange[categoryIndex] }}\n              <uni-icons type=\"down\" size=\"18\" color=\"#999\" class=\"picker-icon\"></uni-icons>\n            </view>\n          </picker>\n        </view>\n        \n        <view class=\"picker-item\">\n          <text class=\"picker-label\">状态:</text>\n          <picker \n            mode=\"selector\"\n            :range=\"statusRange\"\n            :value=\"statusIndex\"\n            @change=\"handleStatusChange\"\n            class=\"custom-picker\"\n          >\n            <view class=\"picker-display\">\n              {{ statusRange[statusIndex] }}\n              <uni-icons type=\"down\" size=\"18\" color=\"#999\" class=\"picker-icon\"></uni-icons>\n            </view>\n          </picker>\n        </view>\n      </view>\n    </view>\n    \n    <!-- 需求列表说明 -->\n    <view class=\"list-note\">\n      <uni-icons type=\"info\" size=\"24\" color=\"#7c89ff\" class=\"note-icon\"></uni-icons>\n      <text class=\"note-text\">注：已完成的需求无法编辑和删除，相关按钮将自动隐藏</text>\n    </view>\n    \n    <!-- 需求列表 -->\n    <view class=\"demand-list\">\n      <view v-if=\"isLoading\" class=\"loading-state\">\n        <uni-icons type=\"loading\" size=\"40\" color=\"#7c89ff\" spin></uni-icons>\n        <text class=\"loading-text\">加载中...</text>\n      </view>\n      \n      <view \n        class=\"demand-row\" \n        v-else-if=\"filteredDemands.length > 0\"\n        v-for=\"demand in filteredDemands\" \n        :key=\"demand.id\"\n      >\n        <view class=\"demand-info\" @click=\"navigateToDetail(demand.id)\">\n          <image :src=\"demand.imgUrl || 'https://api.shaolezhuan.cn/lzphoto/demandpic.png'\" mode=\"widthFix\" class=\"demand-img\"></image>\n          \n          <view class=\"demand-text-content\">\n            <view class=\"demand-title\">{{ demand.title }}</view>\n            \n            <view class=\"demand-meta\">\n              <text class=\"demand-budget\">¥{{ demand.budget.toFixed(2) }}</text>\n              <text class=\"publish-time\">{{ formatTime(demand.publishTime) }}</text>\n              <text class=\"demand-location\">\n                <uni-icons type=\"map-pin\" size=\"18\" color=\"#999\"></uni-icons>\n                {{ demand.location }}\n              </text>\n            </view>\n            \n            <view class=\"demand-status\">\n              <view class=\"status-badge\" :class=\"getStatusClass(demand.status)\">\n                {{ convertStatusToChinese(demand.status) }}\n              </view>\n              <view class=\"tags-container\">\n                <uni-tag \n                  v-if=\"demand.isTop === 1\"\n                  size=\"mini\"\n                  text=\"已置顶\"\n                  type=\"primary\"\n                ></uni-tag>\n                <uni-tag \n                  v-if=\"demand.isOnHome\"\n                  size=\"mini\"\n                  text=\"首页展示\"\n                  type=\"success\"\n                ></uni-tag>\n              </view>\n            </view>\n          </view>\n        </view>\n        \n        <view class=\"demand-actions\" v-if=\"convertStatusToChinese(demand.status) !== '已完成'\">\n          <button \n            class=\"action-btn edit-btn\" \n            @click.stop=\"handleOpenEditPopup(demand)\"\n          >\n            <uni-icons type=\"compose\" size=\"20\" color=\"#409EFF\"></uni-icons>\n          </button>\n          <button \n            class=\"action-btn delete-btn\" \n            @click.stop=\"deleteDemand(demand.id)\"\n          >\n            <uni-icons type=\"trash\" size=\"20\" color=\"#F56C6C\"></uni-icons>\n          </button>\n        </view>\n      </view>\n      \n      <view class=\"empty-state\" v-else>\n        <uni-icons type=\"empty\" size=\"60\" color=\"#ccc\"></uni-icons>\n        <text class=\"empty-text\">暂无符合条件的需求</text>\n        <button class=\"publish-btn\" @click=\"goToPublish\">发布新需求</button>\n      </view>\n    </view>\n  \n    <uni-popup \n      ref=\"editPopup\"\n      type=\"bottom\"\n      :mask=\"true\"\n      :mask-click=\"false\"\n      class=\"edit-popup\"\n    >\n      <view class=\"edit-dialog\">\n        <!-- 调整预算输入区域 -->\n        <view class=\"budget-edit-container\">\n          <text class=\"budget-label\">调整预算:</text>\n          <input \n            type=\"number\" \n            v-model=\"newBudget\"\n            step=\"0.01\"\n            min=\"0.01\"\n            class=\"budget-input\"\n            placeholder=\"输入新预算\"\n          />\n        </view>\n        \n        <!-- 操作按钮区域 -->\n        <view class=\"action-buttons\">\n          <button \n            class=\"operation-btn top-btn\" \n            @click=\"setDemandTop\"\n            :disabled=\"currentDemand?.isTop\"\n            v-if=\"currentDemand?.status !== 'resolved' && !currentDemand?.isTop\"\n          >\n            置顶\n          </button>\n          <button \n            class=\"operation-btn home-btn\" \n            @click=\"setDemandToHome\"\n            :disabled=\"currentDemand?.isOnHome\"\n            v-if=\"currentDemand?.status !== 'resolved' && !currentDemand?.isOnHome\"\n          >\n            上首页\n          </button>\n          <!-- 确认完成交易按钮 -->\n          <button \n            class=\"operation-btn complete-btn\" \n            @click=\"confirmCompleteTransaction\"\n            v-if=\"!currentDemand?.isDraft && currentDemand?.status !== 'resolved'\"\n          >\n            确认完成交易\n          </button>\n        </view>\n        \n        <!-- 确认调整预算按钮 -->\n        <button class=\"confirm-budget-btn\" @click=\"confirmBudgetAdjustment\">\n          确认调整\n        </button>\n        \n        <!-- 取消按钮 -->\n        <button class=\"dialog-cancel\" @click=\"CancelEdit\">\n          取消\n        </button>\n      </view>\n    </uni-popup>\n  </view>\n</template>\n\n<script setup>\nimport { ref, onMounted, computed, nextTick } from 'vue';\n// 导入需求相关接口\nimport productApi from '@/api/product.js';\nimport { ensureLoggedIn } from '@/utils/uniHelper';\n\n// 基础状态\nconst searchKeyword = ref('');\nconst isLoading = ref(false);\nconst currentDemand = ref(null);\nconst newBudget = ref('');\nconst editPopup = ref(null);\n\n// Picker筛选配置\nconst categoryRange = ref(['全部分类']);\nconst statusRange = ref(['全部状态', '待审核', '已上架','已拒绝','已完成']);\nconst categoryIndex = ref(0);\nconst statusIndex = ref(0);\n\n// 需求数据\nconst publishedDemands = ref([]);\n\n// 页面加载时获取需求列表\nonMounted(() => {\n  if (!ensureLoggedIn({ content: '登录后才能查看我的需求', redirectTo: '/pages/mine/mine' })) return;\n  fetchMyDemands();\n  // 监听页面显示事件，重新获取数据\n  uni.$on('pageShow', fetchMyDemands);\n});\n\n// 状态转换为中文\nconst convertStatusToChinese = (englishStatus) => {\n  const statusMap = {\n      'pending_review': '待审核',\n      'active': '已上架',\n      'rejected': '已拒绝',\n      'resolved': '已完成'\n    };\n  return statusMap[englishStatus] || englishStatus;\n};\n\n// 获取我的需求列表\nconst fetchMyDemands = async () => {\n  try {\n    isLoading.value = true;\n    const myData = { current: 1, size: 1000 };\n    const res = await productApi.getMyDemands(myData);\n    const rawDemandsList = res.data.records || [];\n\n    // 处理需求数据（确保“category”字段存储分类名称）\n    publishedDemands.value = rawDemandsList\n      .filter(raw => raw.status !== 'delisted')\n      .map(raw => ({\n        id: raw.id,\n        title: raw.title,\n        desc: raw.description || '',\n        imgUrl: raw.imageUrl || 'https://api.shaolezhuan.cn/lzphoto/demandpic.png',\n        budget: raw.budget || 0,\n        publishTime: raw.createdAt ? new Date(raw.createdAt).getTime() : Date.now(),\n        status: raw.status || 'pending_review', // 明确状态字段\n        category: raw.categoryName || '其他', // 假设后端返回“categoryName”存储分类名称\n        isTop: raw.urgentPush || false,\n        isOnHome: raw.isHomepageFeatured || false\n      }));\n\n    // 动态生成分类选项（去重后添加“全部种类”）\n    const categories = [...new Set(publishedDemands.value.map(item => item.category))];\n    categoryRange.value = ['全部分类', ...categories];\n  } catch (error) {\n    console.error('获取需求列表失败:', error);\n    uni.showToast({ title: '加载需求失败', icon: 'none' });\n  } finally {\n    isLoading.value = false;\n  }\n};\n\n// 筛选逻辑（统一按中文状态比较，兼容后端返回英文或中文）\nconst filteredDemands = computed(() => {\n  return publishedDemands.value.filter(demand => {\n    // 1. 搜索筛选：标题/描述包含关键词\n    const matchesSearch = searchKeyword.value === ''\n      ? true\n      : demand.title.toLowerCase().includes(searchKeyword.value.toLowerCase())\n        || (demand.desc && demand.desc.toLowerCase().includes(searchKeyword.value.toLowerCase()));\n\n    // 2. 分类筛选：若选择“全部种类”则不筛选，否则匹配分类名称\n    const selectedCategory = categoryRange.value[categoryIndex.value];\n    const matchesCategory = selectedCategory === '全部分类'\n      ? true\n      : demand.category === selectedCategory;\n\n    // 3. 状态筛选：若选择“全部状态”则不筛选；否则将需求状态转为中文再比较\n    const selectedStatus = statusRange.value[statusIndex.value];\n    const demandStatusCN = convertStatusToChinese(demand.status);\n    const matchesStatus = selectedStatus === '全部状态'\n      ? true\n      : demandStatusCN === selectedStatus;\n\n    return matchesSearch && matchesCategory && matchesStatus;\n  });\n});\n\n// Picker事件处理\nconst handleCategoryChange = (e) => {\n  categoryIndex.value = e.detail.value;\n  fetchMyDemands();\n};\n\nconst handleStatusChange = (e) => {\n  statusIndex.value = e.detail.value;\n  fetchMyDemands();\n};\n\nconst handleSearch = () => {\n  // 搜索由computed自动触发本地筛选\n};\n\n// 状态样式映射\nconst getStatusClass = (status) => {\n  const classMap = {\n    'pending_review': 'status-pending',    // 待审核状态样式\n    'active': 'status-onsale',     // 已上架/出售中样式\n    'rejected': 'status-rejected',   // 已拒绝状态样式\n    'resolved': 'status-completed'   // 已完成状态样式（如有需要）\n  };\n  return classMap[status] || 'status-default';\n};\n\n// 时间格式化\nconst formatTime = (timestamp) => {\n  const now = Date.now();\n  const diff = now - timestamp;\n  \n  if (diff < 3600 * 1000) {\n    return `${Math.floor(diff / (60 * 1000))}分钟前`;\n  } else if (diff < 24 * 3600 * 1000) {\n    return `${Math.floor(diff / (3600 * 1000))}小时前`;\n  } else {\n    return `${Math.floor(diff / (24 * 3600 * 1000))}天前`;\n  }\n};\n\n// 导航到需求详情\nconst navigateToDetail = (id) => {\n  uni.navigateTo({\n    url: `/pages/demandDetail/demandDetail?id=${id}`\n  });\n};\n\n// 打开编辑弹窗\nconst handleOpenEditPopup = async (demand) => {\n  try {\n    currentDemand.value = { ...demand };\n    newBudget.value = demand.budget.toString();\n    await nextTick();\n    editPopup.value?.open('bottom');\n  } catch (error) {\n    console.error('打开编辑弹窗失败:', error);\n    uni.showToast({ title: '打开弹窗失败', icon: 'none' });\n  }\n};\n\n// 显示已完成提示\nconst showCompletedTip = () => {\n  uni.showModal({\n    title: '提示',\n    content: '已完成的需求无法编辑',\n    showCancel: false,\n    confirmText: '知道了'\n  });\n};\n\nconst CancelEdit = () => {\n  editPopup.value?.close();\n};\n\n// 确认调整预算\nconst confirmBudgetAdjustment = async () => {\n  if (!currentDemand.value) return;\n  \n  // 校验预算\n  if (!newBudget.value || isNaN(newBudget.value) || parseFloat(newBudget.value) <= 0) {\n    uni.showToast({\n      title: '请输入有效的预算金额',\n      icon: 'none',\n      duration: 2000\n    });\n    return;\n  }\n\n  try {\n    isLoading.value = true;\n    // 调用调整预算接口\n    const res = await productApi.updateDemandBudget(\n      currentDemand.value.id,\n      { budget: parseFloat(newBudget.value) }\n    );\n    \n    if (res.code === 200) {\n      uni.showToast({ title: '预算调整成功', icon: 'success' });\n      fetchMyDemands();\n\t  // 更新本地数据\n      const index = publishedDemands.value.findIndex(item => item.id === currentDemand.value.id);\n      if (index !== -1) {\n        publishedDemands.value[index].budget = parseFloat(newBudget.value);\n      }\n    } else {\n      uni.showToast({\n        title: `调整失败：${res.msg}`,\n        icon: 'none'\n      });\n    }\n    \n    editPopup.value?.close();\n  } catch (error) {\n    console.error('调整预算失败:', error);\n    uni.showToast({ title: '调整失败', icon: 'none' });\n  } finally {\n    isLoading.value = false;\n  }\n};\n\n// 设置需求置顶\nconst setDemandTop = async () => {\n  if (!currentDemand.value || currentDemand.value.isTop) return;\n\n  try {\n    isLoading.value = true;\n\tconst targetTopStatus = true;\t\n    const demandId = currentDemand.value.id;\n    // 调用置顶接口\n    const res = await productApi.setDemandTop(demandId);\n    \n\tconsole.log('置顶情况',res)\n\t\n    if (res.code === 200) {\n      uni.showToast({\n        title: '需求已申请置顶',\n        icon: 'success'\n      });\n\t  fetchMyDemands();\n      // 更新本地数据\n      const index = publishedDemands.value.findIndex(item => item.id === currentDemand.value.id);\n      if (index !== -1) {\n        publishedDemands.value[index].isTop = true;\n      }\n    } else {\n      uni.showToast({\n        title: `置顶失败：${res.msg}`,\n        icon: 'none'\n      });\n    }\n    \n    editPopup.value?.close();\n  } catch (error) {\n    console.error('置顶操作失败:', error);\n    uni.showToast({ title: '操作失败', icon: 'none' });\n  } finally {\n    isLoading.value = false;\n  }\n};\n\n// 设置需求上首页\nconst setDemandToHome = async () => {\n  if (!currentDemand.value || currentDemand.value.isOnHome) return;\n\n  try {\n    isLoading.value = true;\n\tconst targetStatus = true;\n    const demandId = currentDemand.value.id;\n    // 调用上首页接口\n    const res = await productApi. setDemandTohome(demandId);\n    \n    if (res.code === 200) {\n      uni.showToast({\n        title: '需求已申请上首页推荐',\n        icon: 'success'\n      });\n\t  fetchMyDemands();\n      // 更新本地数据\n      const index = publishedDemands.value.findIndex(item => item.id === currentDemand.value.id);\n      if (index !== -1) {\n        publishedDemands.value[index].isOnHome = true;\n      }\n    } else {\n      uni.showToast({\n        title: `推荐失败：${res.msg}`,\n        icon: 'none'\n      });\n    }\n    \n    editPopup.value?.close();\n  } catch (error) {\n    console.error('设置首页展示失败:', error);\n    uni.showToast({ title: '操作失败', icon: 'none' });\n  } finally {\n    isLoading.value = false;\n  }\n};\n\n// 确认完成交易\nconst confirmCompleteTransaction = async () => {\n  if (!currentDemand.value || currentDemand.value.status === 'resolved') {\n    uni.showToast({ title: '该需求已完成交易', icon: 'none' });\n    return;\n  }\n  \n  // 二次确认\n  uni.showModal({\n    title: '确认完成交易',\n    content: '确定要将此需求标记为已完成吗？标记后将无法编辑',\n    confirmText: '确认',\n    cancelText: '取消',\n    success: async (res) => {\n      if (res.confirm) {\n        try {\n          isLoading.value = true;\n          // 调用状态更新接口\n          await productApi.updateDemandStatus(\n            currentDemand.value.id,\n            { status: 'resolved' }\n          );\n          \n          // 更新本地数据\n          const index = publishedDemands.value.findIndex(item => item.id === currentDemand.value.id);\n          if (index !== -1) {\n            publishedDemands.value[index].status = 'resolved';\n          }\n          \n          uni.showToast({ title: '已标记为完成', icon: 'success' });\n          editPopup.value?.close();\n        } catch (error) {\n          console.error('标记完成失败:', error);\n          uni.showToast({ title: '操作失败', icon: 'none' });\n        } finally {\n          isLoading.value = false;\n        }\n      }\n    }\n  });\n};\n\n// 删除需求\nconst deleteDemand = async (id) => {\n  uni.showModal({\n    title: '确认删除',\n    content: '确定要删除该需求吗？删除后不可恢复',\n    confirmText: '删除',\n    cancelText: '取消',\n    success: async (res) => {\n      if (res.confirm) {\n        try {\n          isLoading.value = true;\n          // 调用删除接口\n          const deleteRes = await productApi.deleteDemand(id);\n          console.log('删除需求ID',id)\n          console.log('删除需求反馈',deleteRes)\n          if (deleteRes.code === 200) {\n\t\t\tfetchMyDemands();\n            // 更新本地数据\n            publishedDemands.value = publishedDemands.value.filter(item => item.id !== id);\n            uni.showToast({ title: '需求已删除', icon: 'success' });\n          } else {\n            uni.showToast({ title: `删除失败：${deleteRes.msg}`, icon: 'none' });\n          }\n        } catch (error) {\n          console.error('删除需求失败:', error);\n          uni.showToast({ title: '删除失败', icon: 'none' });\n        } finally {\n          isLoading.value = false;\n        }\n      }\n    }\n  });\n};\n\n// 跳转到发布需求页面\nconst goToPublish = () => {\n  uni.navigateTo({\n    url: `/pages/receive/receive`\n  });\n};\n</script>\n\n<style scoped>\n/* 保持原有样式不变，仅补充状态相关样式 */\n.my-published-page {\n  background-color: #f5f7fa;\n  min-height: 100vh;\n  padding-bottom: 40rpx;\n}\n\n/* 列表说明样式 */\n.list-note {\n  padding: 15rpx 20rpx;\n  background-color: #e6f7ff;\n  margin: 0 20rpx 20rpx;\n  border-radius: 10rpx;\n  display: flex;\n  align-items: center;\n  font-size: 26rpx;\n  color: #1890ff;\n}\n\n.note-icon {\n  margin-right: 10rpx;\n}\n\n/* 导航栏样式 */\n.navbar {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  height: 100rpx;\n  padding: 0 30rpx;\n  background-color: #fff;\n  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);\n  position: sticky;\n  top: 0;\n  z-index: 999;\n}\n\n.nav-title {\n  font-size: 36rpx;\n  font-weight: 600;\n  color: #333;\n}\n\n.add-demand-btn {\n  display: flex;\n  align-items: center;\n  background-color: #7c89ff;\n  color: #fff;\n  font-size: 28rpx;\n  padding: 0 25rpx;\n  margin-right: 16rpx;\n  height: 60rpx;\n  border-radius: 30rpx;\n  box-shadow: 0 4rpx 12rpx rgba(124, 137, 255, 0.3);\n  transition: all 0.2s ease;\n}\n\n.add-demand-btn:hover {\n  background-color: #6a78e0;\n  transform: translateY(-2rpx);\n}\n\n.add-text {\n  margin-left: 8rpx;\n}\n\n/* 筛选区域样式 */\n.filter-container {\n  padding: 20rpx;\n  background-color: #fff;\n  margin-bottom: 20rpx;\n  box-shadow: 0 2rpx 5rpx rgba(0, 0, 0, 0.03);\n}\n\n.search-box {\n  display: flex;\n  align-items: center;\n  background-color: #f5f7fa;\n  border-radius: 60rpx;\n  padding: 0 20rpx;\n  height: 70rpx;\n  margin-bottom: 20rpx;\n}\n\n.search-icon {\n  margin-right: 10rpx;\n}\n\n.search-input {\n  flex: 1;\n  height: 100%;\n  font-size: 28rpx;\n  color: #333;\n  background: transparent;\n}\n\n.picker-container {\n  display: flex;\n  gap: 20rpx;\n  overflow-x: auto;\n  padding-bottom: 10rpx;\n}\n\n.picker-item {\n  display: flex;\n  align-items: center;\n  background-color: #f5f7fa;\n  border-radius: 40rpx;\n  padding: 0 20rpx;\n  height: 60rpx;\n  flex-shrink: 0;\n}\n\n.picker-label {\n  font-size: 28rpx;\n  color: #666;\n  margin-right: 10rpx;\n}\n\n.custom-picker {\n  width: auto;\n}\n\n.picker-display {\n  display: flex;\n  align-items: center;\n  font-size: 28rpx;\n  color: #333;\n  padding: 0 5rpx;\n}\n\n.picker-icon {\n  margin-left: 8rpx;\n}\n\n/* 需求列表样式 */\n.demand-list {\n  padding: 0 20rpx;\n}\n\n.loading-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 100rpx 0;\n  color: #7c89ff;\n}\n\n.loading-text {\n  margin-top: 20rpx;\n  font-size: 28rpx;\n}\n\n.demand-row {\n  display: flex;\n  align-items: center;\n  background-color: #fff;\n  border-radius: 15rpx;\n  padding: 15rpx;\n  margin-bottom: 15rpx;\n  min-height: 180rpx;\n  box-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.03);\n}\n\n.demand-info {\n  display: flex;\n  flex: 1;\n  margin-right: 20rpx;\n  overflow: hidden;\n}\n\n.demand-img {\n  width: 140rpx;\n  height: 140rpx;\n  border-radius: 10rpx;\n  object-fit: cover;\n  flex-shrink: 0;\n  margin-right: 15rpx;\n}\n\n.demand-text-content {\n  flex: 1;\n  overflow: hidden;\n}\n\n.demand-title {\n  font-size: 30rpx;\n  font-weight: 600;\n  color: #333;\n  margin-bottom: 10rpx;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.demand-meta {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 15rpx;\n  margin-bottom: 10rpx;\n  font-size: 24rpx;\n}\n\n.demand-budget {\n  color: #F56C6C;\n  font-weight: 600;\n}\n\n.publish-time, .demand-location {\n  color: #999;\n  display: flex;\n  align-items: center;\n}\n\n.demand-status {\n  display: flex;\n  align-items: center;\n  gap: 10rpx;\n  flex-wrap: wrap;\n}\n\n.status-badge {\n  padding: 3rpx 10rpx;\n  border-radius: 20rpx;\n  font-size: 22rpx;\n  font-weight: 500;\n}\n\n/* 状态标签样式补充 */\n.status-pending {\n  background-color: #e6f7ff;\n  color: #1890ff;\n}\n\n.status-onsale {\n  background-color: #f0f9eb;\n  color: #52c41a;\n}\n\n.status-rejected {\n  background-color: #fff1f0;\n  color: #f5222d;\n}\n\n.status-completed {\n  background-color: #f6f6f6;\n  color: #ffaa00;\n}\n\n.publish-badge {\n  padding: 3rpx 10rpx;\n  border-radius: 20rpx;\n  font-size: 22rpx;\n  font-weight: 500;\n}\n\n.publish-draft {\n  background-color: #f0f2f5;\n  color: #8c8c8c;\n}\n\n.publish-published {\n  background-color: #e6f7ff;\n  color: #1890ff;\n}\n\n.tags-container {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 8rpx;\n}\n\n.demand-actions {\n  display: flex;\n  flex-direction: column;\n  gap: 15rpx;\n  flex-shrink: 0;\n}\n\n.action-btn {\n  width: 60rpx;\n  height: 60rpx;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 0;\n}\n\n.edit-btn {\n  background-color: #ecf5ff;\n}\n\n.edit-btn.disabled {\n  background-color: #f5f5f5;\n}\n\n.delete-btn {\n  background-color: #fef0f0;\n}\n\n.empty-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 100rpx 0;\n  color: #ccc;\n}\n\n.empty-text {\n  margin-top: 20rpx;\n  margin-bottom: 40rpx;\n  font-size: 28rpx;\n}\n\n.publish-btn {\n  background-color: #7c89ff;\n  color: #fff;\n  font-size: 28rpx;\n  padding: 0 40rpx;\n  height: 70rpx;\n  border-radius: 35rpx;\n  box-shadow: 0 4rpx 12rpx rgba(124, 137, 255, 0.3);\n}\n\n/* 弹窗样式 */\n.edit-popup {\n  --uni-popup-height: auto;\n}\n\n.edit-dialog {\n  background-color: #fff;\n  border-top-left-radius: 30rpx;\n  border-top-right-radius: 30rpx;\n  padding: 30rpx;\n  display: flex;\n  flex-direction: column;\n  gap: 25rpx;\n}\n\n/* 预算输入区域 */\n.budget-edit-container {\n  display: flex;\n  align-items: center;\n  gap: 15rpx;\n  padding: 10rpx 0;\n  border-bottom: 1px solid #f5f5f5;\n}\n\n.budget-label {\n  font-size: 40rpx;\n  color: #333;\n  width: 300rpx;\n}\n\n.budget-input {\n  flex: 1;\n  height: 80rpx;\n  font-size: 40rpx;\n  border: 1px solid #eee;\n  border-radius: 10rpx;\n  padding: 0 20rpx;\n}\n\n/* 操作按钮区域 */\n.action-buttons {\n  padding: 10rpx 0;\n  display: flex;\n  flex-direction: column;\n  gap: 15rpx;\n}\n\n.operation-btn {\n  width: 100%;\n  height: 80rpx;\n  font-size: 30rpx;\n  border-radius: 10rpx;\n  background-color: #fff;\n  color: #333;\n}\n\n/* 完成交易按钮样式 */\n.complete-btn {\n  background-color: #f0f9eb;\n  color: #52c41a;\n  border: 1px solid #e6f7e9;\n}\n\n/* 确认调整预算按钮 */\n.confirm-budget-btn {\n  width: 100%;\n  height: 80rpx;\n  background-color: #7c89ff;\n  color: #fff;\n  font-size: 30rpx;\n  border-radius: 10rpx;\n}\n\n/* 取消按钮 */\n.dialog-cancel {\n  width: 100%;\n  height: 80rpx;\n  background-color: #fff;\n  color: #333;\n  font-size: 30rpx;\n  border-radius: 10rpx;\n  border: 1px solid #eee;\n}\n</style>","import MiniProgramPage from 'C:/Users/86133/Desktop/demo/Lezhuan/pages/demand/demand.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","onMounted","ensureLoggedIn","uni","productApi","computed","nextTick"],"mappings":"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"}