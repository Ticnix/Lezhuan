{"version":3,"file":"CommonGoodsList.js","sources":["components/CommonGoodsList.vue","D:/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/QzovVXNlcnMvODYxMzMvRGVza3RvcC9kZW1vL0xlemh1YW4vY29tcG9uZW50cy9Db21tb25Hb29kc0xpc3QudnVl"],"sourcesContent":["<template>\n  <view class=\"goods-list\">\n    <!-- 加载状态 -->\n    <view class=\"loading-state\" v-if=\"isLoading\">\n      <uni-icons type=\"loading\" size=\"40\" color=\"#7c89ff\" spin></uni-icons>\n      <text class=\"loading-text\">加载中...</text>\n    </view>\n    \n    <!-- 商品列表 -->\n<view \n      class=\"goods-row\" \n      v-else-if=\"sanitizedGoodsList.length > 0\"\n      v-for=\"goods in sanitizedGoodsList\" \n      :key=\"goods.id\"\n    >\n      <!-- 商品信息区域（点击跳转详情） -->\n      <view class=\"goods-info\" @click=\"handleItemClick(goods.id, goods.type)\">\n        <image :src=\"goods.imgUrl\" mode=\"widthFix\" class=\"goods-img\"></image>\n        \n        <view class=\"goods-text-content\">\n          <!-- 商品标题 -->\n          <view class=\"goods-title\">{{ goods.title }}</view>\n          \n          <!-- 商品价格 -->\n          <view class=\"goods-price\">¥{{ goods.price.toFixed(2) }}</view>\n          \n          <!-- 商品属性标签 -->\n          <view class=\"attributes-container\">\n            <view \n              v-for=\"(attr, index) in goods.attributes\" \n              :key=\"index\"\n              :class=\"['attribute-tag', attr === '可刀' ? 'negotiable' : 'normal']\"\n            >\n              {{ attr }}\n            </view>\n          </view>\n        </view>\n      </view>\n    </view>\n    \n    <!-- 空状态 -->\n    <view class=\"empty-state\" v-else>\n      <uni-icons type=\"empty\" size=\"60\" color=\"#ccc\"></uni-icons>\n      <text class=\"empty-text\">{{ emptyText || '暂无符合条件的商品' }}</text>\n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { defineProps, defineEmits, computed } from 'vue';\nimport uniIcons from '@dcloudio/uni-ui/lib/uni-icons/uni-icons.vue';\nimport { sanitizeImageUrl } from '@/utils/uniHelper';\n\n// 定义组件接收的Props\nconst props = defineProps({\n  /** 商品列表数据 */\n  goodsList: {\n    type: Array,\n    required: true,\n    default: () => []\n  },\n  /** 是否加载中 */\n  isLoading: {\n    type: Boolean,\n    default: false\n  },\n  /** 空状态文本（可选，自定义空提示） */\n  emptyText: {\n    type: String,\n    default: ''\n  },\n  /** 商品详情页路径（可选，默认为'/pages/ProductDetail/ProductDetail'） */\n  detailPath: {\n    type: String,\n    default: '/pages/ProductDetail/ProductDetail'\n  },\n  /** 是否禁用点击跳转到详情 */\n  disableNavigation: {\n    type: Boolean,\n    default: false\n  }\n});\n\n// 统一清洗图片域名，避免非法域名导致图片无法加载\nconst sanitizedGoodsList = computed(() => {\n  return (props.goodsList || []).map(item => {\n    const inferredType = item?.type\n      ? (item.type === 'demand' ? 'demand' : 'product')\n      : (item?.function === '需求' ? 'demand' : 'product');\n    return {\n      ...item,\n      type: inferredType,\n      imgUrl: sanitizeImageUrl(item.imgUrl, inferredType)\n    };\n  });\n});\n\n// 定义组件触发的事件\nconst emit = defineEmits([\n  'go-to-detail',    // 跳转商品详情前触发\n  'navigate-success', // 跳转成功后触发\n  'navigate-fail'     // 跳转失败时触发\n]);\n\n/** 跳转到商品详情页 */\nconst navigateToDetail = (id, type) => {\n  emit('go-to-detail', id);\n  const targetType = type === 'demand' ? 'demand' : 'product';\n  uni.navigateTo({\n    url: `${props.detailPath}?id=${id}&type=${targetType}`,\n    success: () => emit('navigate-success', id),\n    fail: (err) => {\n      emit('navigate-fail', { id, error: err });\n      console.error('跳转详情失败:', err);\n    }\n  });\n};\n\n/** 处理商品点击：支持禁用跳转 */\nconst handleItemClick = (id, type) => {\n  if (props.disableNavigation) return; // 禁用跳转时直接返回\n  navigateToDetail(id, type);\n};\n\ndefineExpose({\n  navigateToDetail\n});\n</script>\n\n<style scoped>\n/* 商品列表容器 */\n.goods-list {\n  padding: 0 20rpx;\n}\n\n/* 加载状态 */\n.loading-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 100rpx 0;\n  color: #7c89ff;\n}\n\n.loading-text {\n  margin-top: 20rpx;\n  font-size: 28rpx;\n}\n\n/* 商品项行 */\n.goods-row {\n  display: flex;\n  align-items: center;\n  background-color: #fff;\n  border-radius: 15rpx;\n  padding: 15rpx;\n  margin-bottom: 15rpx;\n  min-height: 180rpx;\n  box-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.03);\n  transition: transform 0.1s ease, box-shadow 0.1s ease;\n}\n\n.goods-row:active {\n  transform: scale(0.99);\n  box-shadow: 0 1rpx 4rpx rgba(0, 0, 0, 0.05);\n}\n\n/* 商品信息区域 */\n.goods-info {\n  display: flex;\n  flex: 1;\n  margin-right: 20rpx;\n  overflow: hidden;\n}\n\n/* 商品图片 */\n.goods-img {\n  width: 140rpx;\n  height: 140rpx;\n  border-radius: 10rpx;\n  object-fit: cover;\n  flex-shrink: 0;\n  margin-right: 15rpx;\n}\n\n/* 商品文本内容 */\n.goods-text-content {\n  flex: 1;\n  overflow: hidden;\n}\n\n/* 商品标题 */\n.goods-title {\n  font-size: 30rpx;\n  font-weight: 600;\n  color: #333;\n  margin-bottom: 10rpx;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n/* 商品价格 */\n.goods-price {\n  color: #F56C6C;\n  font-weight: 600;\n  font-size: 28rpx;\n  margin-bottom: 10rpx;\n}\n\n/* 属性标签容器 */\n.attributes-container {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 8rpx;\n}\n\n/* 属性标签样式 */\n.attribute-tag {\n  padding: 3rpx 10rpx;\n  border-radius: 20rpx;\n  font-size: 22rpx;\n  font-weight: 500;\n}\n\n/* 可刀标签（红色） */\n.attribute-tag.negotiable {\n  background-color: #fff1f0;\n  color: #f5222d;\n}\n\n/* 其他标签（蓝色） */\n.attribute-tag.normal {\n  background-color: #e6f7ff;\n  color: #1890ff;\n}\n\n/* 空状态样式 */\n.empty-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 100rpx 0;\n  color: #ccc;\n}\n\n.empty-text {\n  margin-top: 20rpx;\n  margin-bottom: 40rpx;\n  font-size: 28rpx;\n}\n</style>","import Component from 'C:/Users/86133/Desktop/demo/Lezhuan/components/CommonGoodsList.vue'\nwx.createComponent(Component)"],"names":["computed","sanitizeImageUrl","uni"],"mappings":";;;;;;AAkDA,MAAM,WAAW,MAAW;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAI5B,UAAM,QAAQ;AA8Bd,UAAM,qBAAqBA,cAAQ,SAAC,MAAM;AACxC,cAAQ,MAAM,aAAa,CAAA,GAAI,IAAI,UAAQ;AACzC,cAAM,gBAAe,6BAAM,QACtB,KAAK,SAAS,WAAW,WAAW,aACpC,6BAAM,cAAa,OAAO,WAAW;AAC1C,eAAO;AAAA,UACL,GAAG;AAAA,UACH,MAAM;AAAA,UACN,QAAQC,gBAAgB,iBAAC,KAAK,QAAQ,YAAY;AAAA,QACxD;AAAA,MACA,CAAG;AAAA,IACH,CAAC;AAGD,UAAM,OAAO;AAOb,UAAM,mBAAmB,CAAC,IAAI,SAAS;AACrC,WAAK,gBAAgB,EAAE;AACvB,YAAM,aAAa,SAAS,WAAW,WAAW;AAClDC,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,GAAG,MAAM,UAAU,OAAO,EAAE,SAAS,UAAU;AAAA,QACpD,SAAS,MAAM,KAAK,oBAAoB,EAAE;AAAA,QAC1C,MAAM,CAAC,QAAQ;AACb,eAAK,iBAAiB,EAAE,IAAI,OAAO,IAAK,CAAA;AACxCA,wBAAc,MAAA,MAAA,SAAA,yCAAA,WAAW,GAAG;AAAA,QAC7B;AAAA,MACL,CAAG;AAAA,IACH;AAGA,UAAM,kBAAkB,CAAC,IAAI,SAAS;AACpC,UAAI,MAAM;AAAmB;AAC7B,uBAAiB,IAAI,IAAI;AAAA,IAC3B;AAEA,aAAa;AAAA,MACX;AAAA,IACF,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7HD,GAAG,gBAAgB,SAAS;"}